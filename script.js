/* Exported from HecLAvibe ASCII Draw */
const COLS=40
const ROWS=20
const CELL_COUNT=COLS*ROWS

const frames=[{"durationMs":200,"state":["","","","","","","","","","","","","","","","","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"durationMs":200,"state":["","","","","","","","","","","","","","","","","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","","","","","","@","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","@","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","@","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},{"durationMs":200,"state":["","","","","","","","","","","","","","","","","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","*","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]}]

const grid=document.getElementById('grid')
const playBtn=document.getElementById('play')
const pauseBtn=document.getElementById('pause')
const stopBtn=document.getElementById('stop')
const fpsInput=document.getElementById('fps')
const meta=document.getElementById('meta')

let timer=null
let playing=false
let idx=0

function initGrid(){
  for(let i=0;i<CELL_COUNT;i++){
    const c=document.createElement('div')
    c.className='cell'
    grid.appendChild(c)
  }
}

function setState(state){
  const cells=grid.children
  for(let i=0;i<CELL_COUNT;i++){
    cells[i].textContent=state[i]||''
  }
}

function updateMeta(){
  if(!frames.length){meta.textContent='No frames';return}
  const total=frames.reduce((s,f)=>s+(Number(f.durationMs)||0),0)
  meta.textContent='Frame '+(idx+1)+'/'+frames.length+' â€¢ Total '+Math.round(total)+'ms'
}

function schedule(){
  if(!playing || !frames.length) return
  const fps=Math.max(1,Math.min(60,Number(fpsInput.value)||5))
  const fallback=Math.round(1000/fps)
  const delay=Math.max(10,Number(frames[idx].durationMs)||fallback)
  timer=setTimeout(()=>{
    if(!playing) return
    idx=(idx+1)%frames.length
    setState(frames[idx].state)
    updateMeta()
    schedule()
  },delay)
}

function play(){
  if(!frames.length) return
  if(playing) return
  playing=true
  playBtn.disabled=true
  pauseBtn.disabled=false
  stopBtn.disabled=false
  setState(frames[idx].state)
  updateMeta()
  schedule()
}

function pause(){
  if(!playing) return
  playing=false
  if(timer) clearTimeout(timer)
  timer=null
  playBtn.disabled=false
  pauseBtn.disabled=true
  stopBtn.disabled=false
}

function stop(){
  if(timer) clearTimeout(timer)
  timer=null
  playing=false
  idx=0
  playBtn.disabled=false
  pauseBtn.disabled=true
  stopBtn.disabled=true
  if(frames.length){
    setState(frames[0].state)
    updateMeta()
  }
}

playBtn.addEventListener('click',play)
pauseBtn.addEventListener('click',pause)
stopBtn.addEventListener('click',stop)

initGrid()
if(frames.length){
  setState(frames[0].state)
  updateMeta()
}
